#  Write a program to do: A dataset collected in a cosmetics shop showing
# details of customers and whether or not they responded to a special offer
# to buy a new lip-stick is shown in table below. (Use library commands)
# According to the decision tree you have made from the previous training
# data set, what is the decision for the test data: [Age = 21-35, Income = Low,
# Gender = Male, Marital Status = Married]?

import pandas as pd
from sklearn.tree import DecisionTreeClassifier, export_text
from sklearn.preprocessing import LabelEncoder

# ------------------------------
# 1. Load Dataset
# ------------------------------
df = pd.read_csv("/Users/srushtighogare/Downloads/Datasets/Lipstick.csv")
df.columns = [c.strip() for c in df.columns]

# Drop Id column if present
for c in df.columns:
    if "id" in c.lower():
        df = df.drop(columns=[c])
        break

# ------------------------------
# 2. Define features & target
# ------------------------------
target = "Buys"
features = [c for c in df.columns if c != target]

# Encode target labels (Yes/No)
le = LabelEncoder()
y = le.fit_transform(df[target])

# One-hot encode categorical input features
X = pd.get_dummies(df[features], drop_first=False)

# ------------------------------
# 3. Train Decision Tree
# ------------------------------
clf = DecisionTreeClassifier(criterion="entropy", random_state=42)
clf.fit(X, y)

# Print tree rules (optional)
print("\nDecision Tree Rules:\n")
print(export_text(clf, feature_names=list(X.columns)))

# ------------------------------
# 4. Prepare the TEST SAMPLE
# ------------------------------
test_sample = {
    "Age": "21-35",
    "Income": "Low",
    "Gender": "Male",
    "Ms": "Married"
}

test_df = pd.DataFrame([test_sample])
test_X = pd.get_dummies(test_df)

# Make sure test columns match training columns
test_X = test_X.reindex(columns=X.columns, fill_value=0)

# ------------------------------
# 5. Predict using the model
# ------------------------------
pred = clf.predict(test_X)[0]
final_result = le.inverse_transform([pred])[0]

print("\nTest Input:", test_sample)
print("Predicted Decision:", final_result)
